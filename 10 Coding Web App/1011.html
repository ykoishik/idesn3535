<!--

This demo is related to pages 420-423 in Duckett.

There are two kinds of storage on the client-side (inside the web browser):

+ Session Storage. Data stored in session storage is retained only for the lifetime of the given tab/window.

+ Local Storage (via the localStorage object). Data stored in local storage is retained more or less permanently.
  __Good for information that should be stored outside of the browsing session or reuse at a later time.

Note: web browsers typically only store up to 5MB of data per domain.

-->

<!DOCTYPE html>
<html>

<head>
    <title>data storage | in-class demo</title>
    <style type="text/css">
        body { font-family: Helvetica ; line-height: 1.5em ; }
        .label { width: 100px ; float: left ; text-transform: uppercase; font-size: 0.7em ; font-weight: 700; letter-spacing: 1px; }
        .field { width: 800px ;height: 45px ;}
        input { font-size: 1.1em ; padding:3px;}
    </style>

</head>
<body>

<h2>local storage</h2>
<!--form -->
<form id="persisent_form" name="persisent_form" method="post" action="">
    <!--full goal name text-->
    <div class="label">
        <label for="fullname">Goal name:</label>
    </div>
    <!--full name goal box-->
    <div class="field">
        <input type="text" name="fullname" id="fullname" size="40" />
    </div>

<!--task1 text-->
    <div class="label">
        <label for="email">Task 1:</label>
    </div>
    <!--task1 text box-->
    <div class="field">
        <input type="text" name="email" id="email" size="40" />
    </div>

    <!--task1 text box-->
    <div class="label">
        <label for="task name1"></label>
    </div>

    <!--task1 text-->
    <div class="label">
        <label for="email">Task 1:</label>
    </div>
    <!--task1 text box-->
    <div class="field">
        <input type="text" name="email" id="email" size="40" />
    </div>

    <!--task1 text box-->
    <div class="label">
        <label for="task name1"></label>
    </div>

    <!--task1 text-->
    <div class="label">
        <label for="email">Task 1:</label>
    </div>
    <!--task1 text box-->
    <div class="field">
        <input type="text" name="email" id="email" size="40" />
    </div>

    <!--task1 text box-->
    <div class="label">
        <label for="task name1"></label>
    </div>

    <!--task1 text-->
    <div class="label">
        <label for="email">Task 1:</label>
    </div>
    <!--task1 text box-->
    <div class="field">
        <input type="text" name="email" id="email" size="40" />
    </div>

    <!--task1 text box-->
    <div class="label">
        <label for="task name1"></label>
    </div>

    <script type="text/template" id="list-item-template">
        <li class="task">
            <label>
                <input class="checkbox" type="checkbox">
                <span class="task-name"><!-- TASK_NAME --></span>
            </label>
        </li>




    </script>




    <!--task1 text-->
    <div class="label">
        <label for="email">Task 1:</label>
    </div>
    <!--task1 text box-->
    <div class="field">
        <input type="text" name="email" id="email" size="40" />
    </div>

    <!--task1 text box-->
    <div class="label">
        <label for="task name1"></label>
    </div>

    <!--task1 text-->
    <div class="label">
        <label for="email">Task 1:</label>
    </div>
    <!--task1 text box-->
    <div class="field">
        <input type="text" name="email" id="email" size="40" />
    </div>

    <!--task1 text box-->
    <div class="label">
        <label for="task name1"></label>
    </div>



    <!--empty space-->
    <div class="label">&nbsp;
    </div>
    <!--save button-->
    <div class="field">
        <input type="submit" name="save" id="save" value="Save" />
    </div>
</form>
<div>GOAL</div>
<div id="goal_name"> </div>
<p id="task_name"> </p>  <input class="checkbox" type="checkbox">
<span class="task-name"><!-- Task 1 --></span>
</label>
<p id="task name1"> </p>
<p id="task name2"> </p>
<p id="task name3"> </p>
<p id="task name4"> </p>
<p id="task name5"> </p>
<p id="task name6"> </p>
<p id="task name7"> </p>
<p id="task name8"> </p>

<!--

Page 421 in Duckett lists all of the methods and properties of the localStorage object.

-->

<!-- jQuery library via Google CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

<script type="text/javascript">







    //when page is finished loading
    $(document).ready ( function ( ) {
        //create variables
        var local_stored_name, local_stored_mail, local_stored_goal ;

        //??
        var one = JSON.parse(localStorage.goal);
        //alert( one.task1.name );

        // Check if localStorage has the goods when the webpage loads.
        if ( localStorage.length > 0 ) {
            local_stored_name = localStorage.name ;
            local_stored_mail = localStorage.mail ;
            local_stored_goal = localStorage.goal ;
            local_stored_task = localStorage.task ;

            //put information from storage into text boxes
            $('#fullname').val( local_stored_name ) ;
            $('#email').val( local_stored_mail ) ;
            var ls_goal = $.parseJSON(local_stored_goal) ;
            //This is the variable for printing 'username'
            $('#goal_name').text( ls_goal.username ) ;
            $('#task_name').text( local_stored_mail) ;
            //console.log is my best friend.
            console.log(ls_goal.goal_name) ;
        }
    }) ;
        //This activates on submit
    $('#persisent_form').on( 'submit', function (event) {
        //prevents from refreshing page
        event.preventDefault(); // Stop form submission.
        //alert ( '.here')
        //gets the name from the text fields of fullname and email.
        var name = $('#fullname').val() ;
        var mail = $('#email').val() ;
        var goal = $('#goal_name').val () ;
        var task = $('#task_name').val () ;

        // If name is not blank and mail is not blank make 'goal'
        if ( name != '' && mail != '' ) {
         //   var test = { red:'test1',green:'test2',blue:'test3'};
            //goal name = key , after : value
            //goal.task1.due = 'Dec.9th'
            //goal.task2.name = 'My second task'
            //goal.goal_name = 'My first goal'
            var goal = {

                username: name,

                goal_name: 'My first goal',

                task1: {
                    name: 'My first task',
                    due: 'Dec.9th'
                },
                task2: {
                    name: 'My second task'
                }

            }
            localStorage.name = name ;
            localStorage.mail = mail ;
            localStorage.task = task ;
            localStorage.goal = JSON.stringify(goal) ;
            alert ( 'Your info has been saved persistently in localStorage!' );


            var checkbox = targetElement.querySelector(".checkbox");

            if (checkbox.checked) {
                targetElement.classList.add("completed");
            } else {
                targetElement.classList.remove("completed");
            }


            todolistContainer.addEventListener('click', function(event) {
                var targetElement = event.toElement;

                while (!targetElement.classList.contains("task")) {
                    targetElement = targetElement.parentElement;
                }

                var checkbox = targetElement.querySelector(".checkbox");

                if (checkbox.checked) {
                    targetElement.classList.add("completed");
                } else {
                    targetElement.classList.remove("completed");
                }
            });

        }

    });

</script>


</body>
</html>
